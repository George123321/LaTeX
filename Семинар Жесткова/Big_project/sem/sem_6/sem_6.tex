\chapter{{Линейные отображения. Часть 2.}}
Для начала решим небольшой пример по прошлому семинару.
\begin{prim}
	$\phi: M_{2\times 2}\rightarrow M_{2\times 1}, \phi(\textbf{x})=\textbf{x}\begin{psm}
	1\\4\\
	\end{psm}$. Найти матрицу линейного преобразования $A$.
\end{prim}
Запишем базисы:\\
$M_{2\times 2}: \textbf{e}
\left\{
\begin{psm}
1&0\\
0&0\\
\end{psm}
,
\begin{psm}
0&1\\
0&0\\
\end{psm}
,
\begin{psm}
0&0\\
1&0\\
\end{psm}
,
\begin{psm}
0&0\\
0&1\\
\end{psm}
\right\}\\
M_{2\times1}: \textbf{f}
\left\{
\begin{psm}
1\\0
\end{psm}
,
\begin{psm}
0\\1
\end{psm}
\right\}.
$\\
Для удобства в общем виде найдём, что значит наше преобразование:\\
$$
\phi(\textbf{x})=\begin{pmatrixr}
a&b\\
c&d\\
\end{pmatrixr}
\begin{pmatrixr}
1\\4
\end{pmatrixr}
=
\begin{pmatrixr}
a+4b\\c+4d
\end{pmatrixr}.
$$
Далее <<прогоним>> через преобразование базис \textbf{e}:\\
$
\phi(\textbf{e$_1$})=
\begin{psm}
1&0\\
0&0\\
\end{psm}
\begin{psm}
1\\4
\end{psm}
=
\begin{psm}
1\\0
\end{psm}, \quad
\phi(\textbf{e$_2$})=\begin{psm}
4\\0
\end{psm}, \quad
\phi(\textbf{e$_3$})=\begin{psm}
0\\1
\end{psm}, \quad
\phi(\textbf{e$_4$})=\begin{psm}
0\\4
\end{psm}.
$\\
Отсюда, получаем ответ:
$$
A=\begin{pmatrixr}
1&4&0&0\\
0&0&1&4\\
\end{pmatrixr}.
$$
\section{Рассмотрение ядра и образа}
Рассмотрим $\phi: \underset{\dim L=n}{L}\rightarrow \underset{\dim \overline{L}=m}{\overline{L}}$.\\
Ядро: $\ker\phi: \{\textbf{x} \in L: A\textbf{\textbf{x}}=\textbf{o}\}$\\
Очевидно, что ЛНЗ решения такого уравнения формируют ФСР, а ФСР задаёт линейное подпространство. Вспоминая количество столбцов в ФСР, легко получить формулу:
\begin{equation}
\boxed{\dim\ker\phi=n-\Rg A}.
\label{ker}
\end{equation}
Образ $\im\phi: \{\textbf{y} \in \overline{L}:\exists \textbf{x}\in L: A\textbf{x}=\textbf{y}\}$.\\
Аналогично $\im\phi \in \overline{L}$ формирует линейное подпространство т.к.
\begin{center}
	$
	A\textbf{x$_1$}+A\textbf{x$_2$}=A(\textbf{x$_1$}+\textbf{x$_2$})$
	
	$A\alpha \textbf{x}=\alpha A\textbf{x}$.
\end{center}
Выберем в $L$ базис $\textbf{e}:\{\textbf{e$_1$}, \textbf{e$_2$}, \dots, \textbf{e$_n$}\}$.\\
$\forall \textbf{x} \in L: \textbf{x}=\alpha_1\textbf{e$_1$}+\dots+\alpha_n\textbf{e$_n$} \leftarrow \phi$ (это обозначение значит <<подействуем преобразованием $\phi$>>)\\
$\phi(\textbf{x})=\alpha_1 \underset{=\textbf{a$_1$}}{\phi(\textbf{e$_1$})}+\dots+\alpha_n \underset{=\textbf{a$_n$}}{\phi(\textbf{e$_n$})}=\langle \textbf{a$_1$},\dots, \textbf{a$_n$}\rangle$.\\
Заметим, что $\textbf{a$_1$},\dots, \textbf{a$_n$}$ --- столбцы матрицы $A$. Отсюда следует формула:
\begin{equation}
\boxed{\dim\im\phi=\Rg A=r}.
\label{im}
\end{equation}
Сложим формулы \eqref{ker} и \eqref{im} и получим:
\begin{equation}
\boxed{\dim\ker\phi+\dim\im\phi=n}.
\end{equation}
\begin{center}
	В примерах 2--5: $L=\mathbb{R}^4, \overline{L}=\mathbb{R}^3, A=\begin{psm}
	0&0&2&-2\\
	2&-4&1&1\\
	-1&2&1&-2\\
	\end{psm}$.
\end{center}
\begin{prim}
	Найти образ $\textbf{x}=\begin{psm}
	1\\1\\1\\1\\
	\end{psm}$.
\end{prim}
$\phi: A\textbf{x}=\textbf{y}$, т.е. нужно перемножить матрицу $A$ и вектор $\textbf{x}$.\\
$
\begin{psm}
0&0&2&-2\\
2&-4&1&1\\
-1&2&1&-2\\
\end{psm}
\begin{psm}
1\\1\\1\\1
\end{psm}
=
\begin{psm}
0\\0\\0
\end{psm}
=\textbf{o}
\Rightarrow$ ядро не пусто.
\begin{prim}
	Найти прообраз $\textbf{y}=\begin{psm}
	4\\0\\3
	\end{psm}.$
\end{prim}
Итак $\phi: \underline{A}\textbf{x}=\underline{\textbf{y}}$. Мы знаем то, что подчёркнуто. Очевидно, что мы получили СЛУ относительно \textbf{x}. Решим ее.
\\
$\left(\begin{array}{rrrr|r}
0 & 0 & 2 & -2 & 4   \\
2 & -4& 1&1&0\\
-1&2&1&-2&3
\end{array}\right)\xrightarrow[(1)\leftrightarrow(3)]{(3)\cdot0.5;(1)\cdot(-1)} \left( \begin{array}{rrrr|r}
-1&2&1&-2&3   \\
2 & -4& 1&1&0\\
0&0&1&-1&2
\end{array}\right) \xrightarrow{(2)-2(1)} \left( \begin{array}{rrrr|r}
-1&2&1&-2&3   \\
0 & 0& 3&-3&6\\
0&0&1&-1&2
\end{array}\right) 
\rightarrow\\
\xrightarrow{(1)+(2)} 
\begin{matrix}
\overset{
	\left(\begin{array}{rrrr|r} % приписывание иксов в матрице!??!?!?!
	1&-2&0&1&-1   \\
	0&0&1&-1&2 \\
	\end{array}\right)
}{
	\begin{matrix*}
	x_1&x_2&x_3&x_4& \ \ \ \ \ 
	\end{matrix*}
}
\end{matrix}
\rightarrow 
\begin{matrix}
\overset{\left(\begin{array}{rrrr|r}
	1&0&-2&1&-1   \\
	0&1&0&-1&2 \\
	\end{array}\right)
}{
	\begin{matrix*}
	x_1&x_3&x_2&x_4& \ \ \ \ \ 
	\end{matrix*}
}
\end{matrix}$
\vspace{3mm}

$\left( \begin{array}{r}
x_1\\
x_3\\
x_2\\
x_4
\end{array}\right) = \left( \begin{array}{r}
-1\\
2\\
0\\
0
\end{array}\right) + \left( \begin{array}{rr}
2 & -1\\
0&1\\
1&0\\
0&1
\end{array}\right) \left( \begin{array}{r}
c_1\\
c_2
\end{array}\right)$
\vspace{3mm}

$\left( \begin{array}{r}
x_1\\
x_2\\
x_3\\
x_4
\end{array}\right) = \left( \begin{array}{r}
-1\\
0\\
2\\
0
\end{array}\right) + \left( \begin{array}{r}
2\\
1\\
0\\
0
\end{array}\right) c_1 + \left( \begin{array}{r}
-1\\
0\\
1\\
0
\end{array}\right) c_2 $

\begin{prim}
	Найти ядро отображения.
\end{prim}
Для этого нужно решить СЛУ $A\textbf{x}=\textbf{o} \Rightarrow$

$\Rightarrow\ker\varphi:\langle \left( \begin{array}{r} % МАТФУНКЦИИ
2\\
1\\
0\\
0
\end{array}\right), \left( \begin{array}{r}
-1\\
0\\
1\\
0
\end{array}\right)\rangle$\footnote{В примере 2 как раз и был вектор из $\ker\phi$}, \quad $\dim\ker\phi=2$.

\begin{prim}
	Найти образ $\im\varphi$.
\end{prim}
$\im\varphi : \langle \left( \begin{array}{r}
0\\
2\\
-1
\end{array}\right),\left( \begin{array}{r}
0\\
-4\\
2
\end{array}\right),\left( \begin{array}{r}
2\\
1\\
1
\end{array}\right),\left( \begin{array}{r}
-2\\
1\\
-2
\end{array}\right) \rangle$

$A = \begin{pmatrixr}
0 & 2 & -1\\
0 & -4 & 2\\
2 & 1 & 1\\
-2&1&-2\\ \end{pmatrixr}$ \\
Очевидно, что $(2) = -2(1), (4) = (3)+(1) \Rightarrow$ 2 и 4 строку можно вычеркнуть. \\
$\im\varphi :\langle \left( \begin{array}{r}
0\\
2\\
-1
\end{array}\right), \left( \begin{array}{r}
2\\
1\\
1
\end{array}\right) \rangle$\\
$\dim \im\varphi = 2$\\
$\dim \im \varphi +\dim \ker \varphi =4$




\section{Два важных частных случая}

\begin{enumerate}
	\item Если \underline{$\dim\ker\varphi=0$}:
	
	$\dim \im \varphi = n = \Rg A \Rightarrow$ (столбцы ЛНЗ)
	
	$\textbf{y} \in \overline{L}$
	$\ker\varphi = {0}$\\
	Пусть $\textbf{y}=A\textbf{x$_1$}=A\textbf{x$_2$}$
	
	$A(\textbf{x$_1$}-\textbf{x$_2$}) = 0 \Rightarrow \textbf{x$_1$} - \textbf{x$_2$} \in \ker\varphi =\{0\} \Rightarrow \textbf{x$_1$}=\textbf{x$_2$}$
	
	Если $\ker\varphi = \{0\}$, то это \underline{инъекция}.
	
	Оказывается, верно и обратное:
	
	Отображение инъективно $\Leftrightarrow$ $\ker\varphi = {0}$
	
	Докажем в другую сторону:
	
	Пусть $\dim\ker \varphi \geq 1  \Rightarrow \exists \textbf{x$_0$} \neq 0 \in \ker \varphi$
	
	$A\textbf{x}=\textbf{y}$
	
	$A(\textbf{x}+\textbf{x$_0$}) = A\textbf{x}+A\textbf{x$_0$} = \textbf{y}$~---~противоречие инъекции $\Rightarrow \ker\varphi = \{0\}$
	
	Число прообразов = $0, 1, \infty$
	\item Если \underline{$\im\varphi = \mathbb{R}^m = \overline{L}$}:
	
	$\dim \im\varphi = m = \Rg A$~---~строки ЛНЗ $\leftarrow$ \underline{сюръекция}
\end{enumerate}
Биекция $=$ сюръекция $+$ инъекция\\
$\Rg A=n=m$\\
Т.о. \textbf{биекция задаётся невырожденной матрицей}. В таком случае
$$\dim L = \dim \overline L$$
\textsf{Изоморфизм}~--- биективное линейное отображение.\\
Если существует изоморфизм $L \to \overline L$, то говорят, что $L$ и $\overline L$ \textsf{изоморфны}.

\begin{theorem}
	$L$ и $\overline L$ изоморфны$\iff \dim L =
	\dim \overline L$.
\end{theorem}

Для изоморфизма $\exists$ $\varphi^{-1}$ --- \textsf{обратное отображение}, его матрица $A^{-1}$.

\begin{prim}
	Доказать, что отображение $\varphi(f(x)) = 2f(x) + f'(x)$~--- изоморфизм
	в пространстве $P_2$~---  многочленов степени не выше~$2$. Найти $\varphi^{-1}$.
\end{prim}
Стандартный базис $L\colon\{ 1, x, x^2 \}$, где $\textbf{e$_1$}=1$, $\textbf{e$_2$}=x$, $\textbf{e$_3$}=x^2$.\\
Общий вид $f(x) = ax^2 + bx + c$,
$\dim L = 3$.
\begin{gather*}
\varphi(f(x)) = 2ax^2 + 2bx + 2c + 2ax + b =
2ax^2 + (2a + 2b)x + (b + 2c),
\quad
\overline L\colon\{ 1, x, x^2 \}
\end{gather*}
$$
\left.
\begin{aligned}
\varphi (e_1)=2
\left(
\begin{smallmatrix}
2\\ 0\\ 0\\
\end{smallmatrix}
\right) \\
\varphi (e_2)=2x+1
\left(
\begin{smallmatrix}
1\\ 2\\ 0\\
\end{smallmatrix}
\right) \\
\varphi (e_3)=2x^2+2x
\left(
\begin{smallmatrix}
0\\ 2\\ 2\\
\end{smallmatrix}
\right) 
\end{aligned}
\right\}
\Rightarrow
A=
\begin{pmatrix*}[r]
2 & 1 & 0\\
0 & 2 & 2\\
0 & 0 & 2\\
\end{pmatrix*}
$$
$\Rg=3 \Rightarrow$ изоморфизм. Найдем $A^{-1}$:
\begin{gather*}
A^{-1} = \frac{1}{4} \begin{pmatrix*}[r] 2 & -1 & 1 \\ 0 & 2 & -2 \\
0 & 0 & 2 \end{pmatrix*}.
\end{gather*}
Ответ: $\varphi^{-1} \colon A^{-1} = \cfrac{1}{4} \begin{pmatrix*}[r] 2 & -1 & 1 \\ 0 & 2 & -2 \\
0 & 0 & 2 \end{pmatrix*}$.

\section{Матрица отображения в новых базисах.}
Пусть в $L$ и $\overline L$ выбраны базисы $\textbf{e}$ и $\textbf{f}$, задано отображение $\varphi\colon L \to \overline L: A$.
Поменяем базисы: $ \textbf{e}' = \textbf{e} S$, $ \textbf{f}' = \textbf{f} P$.
Найдём $A'$:\\
\begin{gather*}
\textbf{x} \in L,~ \textbf{x}=\left(\begin{smallmatrix}
\xi_1 \\ \vdots\\ \xi_n\\
\end{smallmatrix} \right)=\bm{\xi};~~~~~~
\textbf{y} \in L,~ \textbf{y}=\left(\begin{smallmatrix}
\eta_1 \\ \vdots\\ \eta_n\\
\end{smallmatrix} \right)=\bm{\eta}
\end{gather*}
Из теории отображений: $\bm{\eta} = A \bm{\xi};~~~\bm{\eta}' = A' \bm{\xi}';$\\
Из замены базиса: $	\bm{\eta} = P \bm{\eta}';~~~	\bm{\xi} = S \bm\xi';$

\begin{gather*}
P \bm \eta' = A \bm \xi = AS \bm\xi'
\Rightarrow
\bm\eta' = P^{-1} A S \bm\xi'=A' \bm \xi'
\Rightarrow
\boxed{A' = P^{-1} A S.}
\end{gather*}
Если $\varphi$~--- преобразование, то $P=S$ и $A'=S^{-1}AS$\\

\begin{prim} 
	Дано преобразование $\varphi\colon A = \begin{pmatrix*}[r] 0 & 2 \\ -1 & -3 \end{pmatrix*}$ в базисе $\bf e$. Смена базиса: $\bf e' = \bf e \begin{pmatrix*}[r] 2 & 1 \\ -1 & -1 \end{pmatrix*}$.
	Найти $A'$.\\
	
	Воспользуемся $A'=S^{-1}AS$. Посчитаем $S^{-1}$:\\
	$$S^{-1} =
	\begin{pmatrix*}[r] 1 & 1 \\ -1 & 2 \end{pmatrix*}.$$
\end{prim}
$$
A'=
\begin{pmatrix*}[r]
1 & 1\\
-1 & 2\\
\end{pmatrix*}
\begin{pmatrix*}[r]
0 & 2\\
-1 & -3\\
\end{pmatrix*}
\begin{pmatrix*}[r]
2 & 1\\
-1 & -1\\
\end{pmatrix*}
=
\begin{pmatrix*}[r]
-1 & 0\\
0 & -2\\
\end{pmatrix*}
$$
\section{Линейные функции}
\begin{definition}
	\textsf{Функция} $f(x)$ на линейном пространстве $L$ --- правило, которое $\forall x \in L$ ставит в соответствие $f(x) \rightarrow \mathbb{R} $.
	
	Функция $f$ линейная, если 
	$$
	\left\{
	\begin{array}{rl} % некрасивое выравнивание 
	f(x+y)&=f(x)+f(y)\\
	f(\alpha x)&=\alpha f(x)\\
	\end{array}
	\right.
	$$
\end{definition}


Это частный случай линейного отображения при $m=1$.\\
Примеры:\\ % enumerate, не стал исправлять
а) Присвоить вектору его $i$-тую координату.\\
б) Скалярное произведение \textbf{(\textbf{x}, \textbf{a})}, где \textbf{a} --- фиксированный вектор в $\mathbb{R}^3$.\\
в) Определённый интеграл.\\

$\underset{1 \times n}A$- строка функции $A=(\varphi_1 \cdots \varphi_n)$, где $\varphi_i$ --- образ $i$-го базисного вектора (т.е. $\varphi_i=\varphi$(\textbf{e$_i$}))\\

Линейные функции образуют линейное пространство.

\begin{prim}
	Может ли $ \forall x \in L$ выполняться:\\
	а) $f(x)>0$? 
	б) $f(x)\geq 0$? 
	в) $f(x)=\alpha $? 
\end{prim}
а) Ответ: нет, так как нет нуля;\\
б) Ответ: только если $f(x)\equiv0$;\\
в) Ответ: только для $\alpha\equiv0$, $f(x)\equiv0$.\\
\begin{prim}
	$P(t)$ ---  многочлен степени $\leq n$, $f(P(t))=P'(1)$. Найти $A$.
\end{prim}
Базис: $\{ 1, t,\cdots, t^n\}$\\
$$
\begin{array}{rl}
\varphi (\text{\textbf{e$_1$}})=&0\\
\varphi (\text{\textbf{e$_2$}})=&1\\
\varphi (\text{\textbf{e$_3$}})=&2\\
\hdotsfor{2}\\
\varphi (\text{\textbf{e$_{n+1}$}})=&n\\
\end{array}
$$
Отсюда получаем ответ:
$$A=
\begin{pmatrix*}[r]
0 & 1 & 2 & \cdots & n\\
\end{pmatrix*}$$